<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Kochi Metro Rail Limited</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
/* ===== Your Original Styles (unchanged) ===== */
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:"Poppins", sans-serif; line-height:1.6; color:#003366; scroll-behavior:smooth; background:#f2f5f7; }
nav { display:flex; align-items:center; justify-content:space-between; padding:10px 20px; background:#003366; color:white; position:sticky; top:0; z-index:100; }
nav .logo { display:flex; align-items:center; }
nav .logo img { height:50px; margin-right:10px; }
header { height:80vh; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; background:#cce6ff; position:relative; }
header h1 { font-size:3rem; margin-bottom:20px; }
header p { font-size:1.2rem; margin-bottom:10px; }
header #heroQuote { font-style:italic; margin-bottom:20px; font-size:2.8rem; color:#003366; }
.content {
  background: rgba(255, 255, 255, 0.3);
  padding: 15px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  backdrop-filter: blur(5px);
  max-width: 50%;
  margin: 0 auto;
  height: auto;
}
.btn-group button { 
  background:#0077b6; 
  color:white; 
  border:none; 
  padding:15px 35px; 
  margin:10px; 
  font-weight:bold; 
  border-radius:30px; 
  cursor:pointer; 
  transition:all 0.3s; 
}
.btn-group button:hover { background:#3399ff; }
#hero{ background-image: url('front-img.jpg'); background-size: cover; background-position: center; }
#why { padding:60px 20px; text-align:center; background:#e6f2ff; color:#003366; }
#why h2 { font-size:2.5rem; margin-bottom:20px; }
#why p { font-size:1.1rem; max-width:900px; margin:0 auto 40px auto; }
#why .photos { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; }
#why .photos img { width:250px; height:150px; object-fit:cover; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.2); transition:0.3s; }
#why .photos img:hover { transform:scale(1.05); }
footer { background:#003366; color:white; text-align:center; padding:20px 10px; margin-top:20px; }
footer a { color:#99ccff; }
footer a:hover { text-decoration:underline; }
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:999; }
.modal-content { background: rgba(255,255,255,0.95); color:#003366; width:400px; padding:25px; border-radius:20px; position:relative; animation: fadeIn 0.4s ease-in-out; box-shadow:0 4px 20px rgba(0,0,0,0.2); }
.close { position:absolute; top:10px; right:15px; font-size:1.5rem; cursor:pointer; color:#003366; }
.tabs { display:flex; justify-content:space-around; margin-bottom:15px; border-bottom:2px solid #cce6ff; }
.tab { flex:1; text-align:center; padding:10px; cursor:pointer; font-weight:bold; transition:0.3s; }
.tab.active { border-bottom:3px solid #0077b6; color:#0077b6; }
.form { display:none; text-align:left; }
.form.active { display:block; }
input, select { width:100%; padding:12px; margin:8px 0; border:1px solid #cce6ff; border-radius:8px; outline:none; }
.submit-btn { background:#0077b6; color:white; border:none; padding:12px; width:100%; border-radius:8px; cursor:pointer; font-weight:bold; transition:0.3s; }
.submit-btn:hover { background:#3399ff; }
.message { margin:5px 0; color:red; font-size:0.9em; }
.message.success { color:green; }
@keyframes fadeIn { from {opacity:0; transform:scale(0.8);} to {opacity:1; transform:scale(1);} }
@media(max-width:768px){ nav ul { flex-direction:column; } header h1 { font-size:2rem; } .modal-content { width:90%; } .content{ max-width:80%; } }
</style>
</head>
<body>

<nav>
  <div class="logo">
    <img src="logo1.jpg" alt="Logo"/>
    <h1>Kochi Metro Rail Limited</h1>
  </div>
</nav>

<header id="hero">
  <div class="content">
     <p id="heroQuote"></p>
    <h3>Connecting the city with speed, comfort and style</h3>
    <div class="btn-group">
      <button onclick="openModal('customer')"><i class="fas fa-user"></i> Customer Login</button>
      <button onclick="openModal('admin')"><i class="fas fa-user-shield"></i> Admin Login</button>
    </div>
  </div>
</header>

<section id="why">
  <h2>Why Travel by Kochi Metro?</h2>
  <p>Kochi Metro provides a fast, safe, and eco-friendly way to travel across the city. It reduces traffic congestion, saves time, and connects key business and tourist areas efficiently.</p>
</section>

<footer id="contact">
  <p>&copy; 2025 Kochi Metro Rail Limited</p>
  <p>Email: info@kochimetro.org | Phone: +91 484 1234567</p>
</footer>

<div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h2 id="modalTitle">Login</h2>
    <div class="tabs">
      <div class="tab active" onclick="switchTab('login')">Login</div>
      <div class="tab" onclick="switchTab('signup')">Sign Up</div>
    </div>

    <form id="loginForm" class="form active">
      <input type="text" id="loginUsername" placeholder="Username" required />
      <input type="password" id="loginPassword" placeholder="Password" required />
      <button type="submit" class="submit-btn">Login</button>
    </form>

    <form id="signupForm" class="form">
      <input type="text" id="signupUsername" placeholder="Username" required />
      <input type="password" id="signupPassword" placeholder="Password" required />
      <select id="signupRole">
        <option value="customer">Customer</option>
        <option value="admin">Admin</option>
      </select>
      <button type="submit" class="submit-btn">Sign Up</button>
    </form>
  </div>
</div>

<script>
/* ==== Quotes ==== */
const quotes = [
  "The Metro is the city’s pulse — fast, reliable, and clean.",
  "Ride the Kochi Metro and beat the city traffic.",
  "Comfort and speed in every ride — that’s Kochi Metro.",
  "Travel smart. Travel green. Choose Kochi Metro.",
  "Connecting communities, powering progress — Kochi Metro."
];
let quoteIndex = 0;
function changeQuote() {
  document.getElementById('heroQuote').textContent = quotes[quoteIndex];
  quoteIndex = (quoteIndex + 1) % quotes.length;
}
changeQuote();
setInterval(changeQuote, 8000);

/* ==== Modal ==== */
let currentLoginType = "customer";
function openModal(type) {
  currentLoginType = type;
  document.getElementById('loginModal').style.display = 'flex';
  document.getElementById('modalTitle').textContent = type === 'admin' ? 'Admin Login' : 'Customer Login';
  switchTab('login');
}
function closeModal() {
  document.getElementById('loginModal').style.display = 'none';
}
function switchTab(tab) {
  const loginForm = document.getElementById('loginForm');
  const signupForm = document.getElementById('signupForm');
  const tabs = document.querySelectorAll('.tab');
  tabs.forEach(t => t.classList.remove('active'));
  if(tab === 'login') {
    loginForm.classList.add('active');
    signupForm.classList.remove('active');
    tabs[0].classList.add('active');
  } else {
    loginForm.classList.remove('active');
    signupForm.classList.add('active');
    tabs[1].classList.add('active');
  }
}

/* ==== Safe Fetch Helper ==== */
async function safeFetch(url, options = {}) {
  try {
    const res = await fetch(url, options);
    const text = await res.text(); // <-- read as text first
    let data;
    try {
      data = JSON.parse(text);
    } catch {
      throw new Error("Server returned non-JSON response: " + text);
    }

    if (!res.ok) throw new Error(data.message || "Request failed");
    return data;
  } catch (err) {
    alert("⚠️ " + err.message);
    throw err;
  }
}

/* ==== Signup ==== */
document.getElementById("signupForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const username = document.getElementById("signupUsername").value.trim();
  const password = document.getElementById("signupPassword").value.trim();
  const role = document.getElementById("signupRole").value;

  const data = await safeFetch("/api/signup", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password, role })
  });

  alert("✅ " + data.message);
  switchTab("login");
});

/* ==== Login ==== */
document.getElementById("loginForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const username = document.getElementById("loginUsername").value.trim();
  const password = document.getElementById("loginPassword").value.trim();

  const data = await safeFetch("/api/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username, password })
  });

  alert("✅ " + data.message);
  localStorage.setItem("token", data.token);
  localStorage.setItem("role", data.role);

  if (data.role === "admin") {
    window.location.href = "/dashboard.html";
  } else {
    window.location.href = "/userpage.html";
  }
});
</script>
</body>
</html>
